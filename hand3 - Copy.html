<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script src="https://handsontable.com/docs/scripts/fixer.js"></script>

<script src="https://handsontable.com/docs/4.0.0/scripts/jquery.min.js"></script>
<script src="https://handsontable.com/docs/4.0.0/components/handsontable-pro/dist/handsontable.full.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://handsontable.com/docs/4.0.0/components/handsontable-pro/dist/handsontable.full.min.css">
<script src="https://unpkg.com/sheetclip"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>

</head>
  <!-- <body onload="handleFct()"> -->
  <body>

    <div id='toolbarid'>
  <button onclick="undohandstonetable()" class='material-symbols-outlined' style="font-size:18px;cursor:pointer;">undo</button>
  <button onclick="redohandstonetable()" class='material-symbols-outlined' style="font-size:18px;cursor:pointer;">redo</button>
  <button class='material-symbols-outlined' style="font-size:18px;cursor:pointer;">format_bold</button>   
  <!-- <button  onclick="sendValue()" class='material-symbols-outlined' style="font-size:18px;cursor:pointer;">save</button> 
     <br>
  <button onclick="handleFct()" class='material-symbols-outlined' style="font-size:18px;cursor:pointer;">sync</button>        
-->
    </div>
    
    <div id="example1" class="hot handsontable htRowHeaders htColumnHeaders"></div>
<style>
     .handsontable table thead th{
    color: black;
    font-size: 12px;
    font-family: sans-serif;
    }

    .handsontable{
      font-size: 12px;
      font-family: Roboto;
    }

    td.custom-titlecell {
      background-color: rgb(204,204,204);
      font-weight: bold;
      border-left: 2px solid black;
      border-right: 0px solid black;
      border-top: 2px solid black;
      border-bottom: 2px solid black;
    }

    td.custom-titlecell2 {
      background-color: rgb(204,204,204);
      font-weight: bold;
      border-left: 2px solid black;
      border-right: 0px solid black;
      border-top: 0px solid black;
      border-bottom: 2px solid black;
    }
</style>
<script>

 

  
      function handleFct(){
     console.log('we are in handlefct')
        /* google.script.run.withSuccessHandler((v) => {
        console.log("we are inside handlefct : ")
          //console.log(v.valueoutput)
          //console.log(JSON.parse(v.valueoutput))
          hotInstance.loadData(JSON.parse(v.valueoutput))
       }).processForm()
      */
      }
      
      
      function undohandstonetable() {
          hotInstance.undo(true);
      }
      function redohandstonetable() {
          hotInstance.redo(false);
      }
      
      
      function getData() {
           return [
            ['Etat ','','','','','','','','','','','','','','',''],
            ['Etat2','','','','','','','','','','','','','','',''],
            ['','','','','','','','','','','','','','','','',''],
            //['','','','','','','','','','','','','','','','','',''],
            //[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],
            ['Projet','Consistance de Projet',"Taux d'avancement des travaux logement",'Taux davancement des travaux VRD','Raccordement en énergie Electrique','','','','','','Raccordement en énergie Gaziere','','','','',''],
            ['','','','','Taux davancement des travaux','Montant des travaux (devis SADEG)','Montant payé (DA)','Créances détenues travaux','Contraintes','Catégoris de Contraintes','Taux davancement des travaux','Montant des travaux (devis SADEG)','Montant payé (DA)','Créances détenues travaux','Contraintes','Catégoris de Contraintes'],
            ['','','','','','','','','','','','','','','','',''],
            ['','','','','','','','','','','','','','','','',''],
            ['','','','','','','','','','','','','','','','',''],
            ['','','','','','','','','','','','','','','','',''],
            ['','','','','','','','','','','','','','','','',''],
            ['','','','','','','','','','','','','','','','',''],
            ['','','','','','','','','','','','','','','','',''],
            ['','','','','','','','','','','','','','','','',''],
            ['','','','','','','','','','','','','','','','',''],
            ['','','','','','','','','','','','','','','','','']
          ];
         }
      
        var container = $("#example1");
        var sheetclip = new SheetClip();
        var clipboardCache = '';
      
      
      container.handsontable({
          data: getData(),
          rowHeaders: true,
          colHeaders: true,
          manualColumnResize: true,
          manualRowResize: true,
          colWidths: [150,100,120,120, 120,120,120,120,100,100,  120,120,120,120,100,100 ],
          undo: true,
          startRows: 6,
          startCols: 5,
          mergeCells: [
    { row: 0, col: 0, rowspan: 1, colspan: 16 },
    { row: 1, col: 0, rowspan: 1, colspan: 16 },

    { row: 3, col: 0, rowspan: 2, colspan: 1 },
    { row: 3, col: 1, rowspan: 2, colspan: 1 },
    { row: 3, col: 2, rowspan: 2, colspan: 1 },
    { row: 3, col: 3, rowspan: 2, colspan: 1 },

    { row: 3, col: 4, rowspan: 1, colspan: 6 },
    { row: 3, col: 10, rowspan: 1, colspan: 6 },




    ],
  cell: [
    { row: 0, col: 0, className: 'htCenter htMiddle' },
    { row: 1, col: 0, className: 'htCenter htMiddle' },
    { row: 2, col: 0, className: 'htLeft htMiddle' },

    { row: 3, col: 0, className: 'htCenter htMiddle custom-titlecell' },
    { row: 3, col: 1, className: 'htCenter htMiddle custom-titlecell' },
    { row: 3, col: 2, className: 'htCenter htMiddle custom-titlecell' },
    { row: 3, col: 3, className: 'htCenter htMiddle custom-titlecell' },
    { row: 3, col: 4, className: 'htCenter htMiddle custom-titlecell' },

    { row: 3, col: 10, className: 'htCenter htMiddle custom-titlecell' },
    
    { row: 4, col: 4, className: 'htCenter htMiddle custom-titlecell2' },
    { row: 4, col: 5, className: 'htCenter htMiddle custom-titlecell2' },
    { row: 4, col: 6, className: 'htCenter htMiddle custom-titlecell2' },
    { row: 4, col: 7, className: 'htCenter htMiddle custom-titlecell2' },
    { row: 4, col: 8, className: 'htCenter htMiddle custom-titlecell2' },
    { row: 4, col: 9, className: 'htCenter htMiddle custom-titlecell2' },

    
    { row: 4, col: 10, className: 'htCenter htMiddle custom-titlecell2' },
    { row: 4, col: 11, className: 'htCenter htMiddle custom-titlecell2' },
    { row: 4, col: 12, className: 'htCenter htMiddle custom-titlecell2' },
    { row: 4, col: 13, className: 'htCenter htMiddle custom-titlecell2' },
    { row: 4, col: 14, className: 'htCenter htMiddle custom-titlecell2' },
    { row: 4, col: 15, className: 'htCenter htMiddle custom-titlecell2' },






  ],

          DragToScroll: true,
          contextMenu: true,
          /*contextMenu: {
            items:{
              "copy":{name:"Copier"},
              "cut":{name:'Couper'},
              "paste":{
                name: 'Coller (Utiliser <b>Ctrl + V</b> avec le clavier)',
                disabled:true
             }
            }

          },*/
          copyPaste: true,
          afterScrollHorizontally:()=>{
            console.log('afterscrollhor is triggered')
          },
           beforeKeyDown:(event)=>{
          //   console.log('beforekeydown is triggred ! ')
          //   const hotgetselected = hotInstance.getSelected();
          //   console.log('getSelected : ');
          //   console.log(hotgetselected)
          //   console.log(event)
          //   if(hotgetselected[0][1]==15){
          //     event.stopImmediatePropagation()
          //   }
            
                console.log(event)
                //event.preventDefault()
          //   //event.stopImmediatePropagation()
           },
          afterChange:(changesvalues,source)=>{
            console.log("we are inside afterChange : ")
            console.log(source)
            console.log(changesvalues)
          }
        });
        
        //// This way, you can access Handsontable api methods by passing their names as an argument, e.g.:
        var hotInstance = $("#example1").handsontable('getInstance');

      
      </script>
          
  </body>
</html>